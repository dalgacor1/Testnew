local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local Player = Players.LocalPlayer 
local PlayerGui = Player:WaitForChild("PlayerGui")

-- ================= REMOTE AUTHORIZATION LOGIC =================

-- Configuration
local USER_LIST_URL = "https://raw.githubusercontent.com/benedettaera/Injector/refs/heads/main/Key"

-- Function to fetch authorized users from remote website
local function fetchAuthorizedUsers()
    -- Try to get the user list from the remote URL
    local success, response = pcall(function()
        return HttpService:GetAsync(USER_LIST_URL, true)  -- true = enable caching
    end)
    
    if success and response then
        local users = {}
        -- Split by lines and clean up
        for line in response:gmatch("[^\r\n]+") do
            local username = line:match("^%s*(.-)%s*$")  -- Trim whitespace
            if username ~= "" and not username:match("^#") then  -- Skip empty lines and comments
                table.insert(users, username)
            end
        end
        return users
    else
        -- Fallback to local list if remote fetch fails
        warn("Failed to fetch user list from remote. Using fallback list.")
        return {
            "dalgacor3"  -- Your default user
            -- Add other fallback users here if needed
        }
    end
end

local function checkAuthorization()
    -- Fetch users from remote website
    local authorizedUsers = fetchAuthorizedUsers()
    
    -- Debug: Print fetched users (optional)
    print("Authorized users list:")
    for _, user in ipairs(authorizedUsers) do
        print("  - " .. user)
    end
    
    -- Check if current user is in the authorized list
    local isAuthorized = false
    for _, username in ipairs(authorizedUsers) do
        if Player.Name == username then
            isAuthorized = true
            break
        end
    end
    
    if not isAuthorized then
        return false, "You don't have an access, contact fb: dalvstorejoki"
    end
    
    return true, "Authorized"
end

-- Execute authorization check
local isAuthorized, reason = checkAuthorization()

if not isAuthorized then
    -- Create a simple unauthorized message
    local UnauthorizedScreenGui = Instance.new("ScreenGui")
    UnauthorizedScreenGui.Name = "UnauthorizedMessage"
    UnauthorizedScreenGui.Parent = PlayerGui
    
    local UnauthorizedFrame = Instance.new("Frame")
    UnauthorizedFrame.Size = UDim2.new(0, 350, 0, 200)
    UnauthorizedFrame.Position = UDim2.new(0.5, -175, 0.5, -100)
    UnauthorizedFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    UnauthorizedFrame.BorderSizePixel = 0
    UnauthorizedFrame.Parent = UnauthorizedScreenGui
    
    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 12)
    UICorner.Parent = UnauthorizedFrame
    
    local Title = Instance.new("TextLabel")
    Title.Size = UDim2.new(1, 0, 0, 50)
    Title.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
    Title.Text = "UNAUTHORIZED"
    Title.TextColor3 = Color3.fromRGB(255, 255, 255)
    Title.TextSize = 22
    Title.Font = Enum.Font.GothamBold
    Title.Parent = UnauthorizedFrame
    
    local Message = Instance.new("TextLabel")
    Message.Size = UDim2.new(0.9, 0, 0, 80)
    Message.Position = UDim2.new(0.05, 0, 0.3, 0)
    Message.BackgroundTransparency = 1
    Message.Text = reason or "You don't have an access, contact fb: dalvstorejoki"
    Message.TextColor3 = Color3.fromRGB(255, 255, 255)
    Message.TextSize = 14
    Message.TextWrapped = true
    Message.Parent = UnauthorizedFrame
    
    local CloseButton = Instance.new("TextButton")
    CloseButton.Size = UDim2.new(0.5, 0, 0, 30)
    CloseButton.Position = UDim2.new(0.25, 0, 0.8, 0)
    CloseButton.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
    CloseButton.Text = "CLOSE"
    CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    CloseButton.TextSize = 14
    CloseButton.Parent = UnauthorizedFrame
    
    CloseButton.MouseButton1Click:Connect(function()
        UnauthorizedScreenGui:Destroy()
    end)
    
    return -- Stop script execution
end

-- If authorized, continue with the rest of the script
print("Authorized! Script can continue...")